{% extends "examples_base.html" %}

{% block content %}

  <div class="container py-5">
    <nav class="mb-4">
      <a href="{% url 'examples:index' %}" class="text-decoration-none">&larr; Back to Examples</a>
    </nav>

    <header class="mb-5">
      <h1 class="h2">Bulk Update</h1>
      <p class="text-muted">Select multiple items and update them together</p>
    </header>

    <section class="card shadow-sm mb-4">
      <div class="card-body">
        <h2 class="h5 mb-3">How it Works</h2>
        <ol class="text-muted small">
          <li>Checkboxes allow selecting multiple contacts</li>
          <li>Select an action (Delete selected)</li>
          <li>
            Form submits selected IDs to <code>/bulk-update/update/</code>
          </li>
          <li>Server processes batch and returns updated table fragment</li>
        </ol>
      </div>
    </section>

    <div class="card shadow-sm">
      <div class="card-body">
        <form id="bulk-form">
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th>
                    <input type="checkbox"
                           class="form-check-input"
                           data-on:change__prevent="@document.querySelectorAll('.contact-checkbox').forEach(cb => cb.checked = $event.target.checked)" />
                  </th>
                  <th>Name</th>
                  <th>Email</th>
                </tr>
              </thead>
              <tbody id="contact-table">
                {% include 'examples/fragments/contact_table.html' %}
              </tbody>
            </table>
          </div>

          <div class="d-flex gap-2 align-items-center">
            <select name="action" class="form-select" style="width: auto;">
              <option value="">Select action...</option>
              <option value="delete">Delete selected</option>
            </select>
            <button type="submit"
                    class="btn btn-primary"
                    data-on:submit__prevent="@post('{% url 'examples:bulk-update-update' %}', {params: {selected_ids: Array.from(document.querySelectorAll('.contact-checkbox:checked')).map(cb => cb.value)}})">
              Apply
            </button>
          </div>
        </form>
      </div>
    </div>

    <section class="card shadow-sm mb-4">
      <div class="card-body">
        <h2 class="h5 mb-3">Learn More</h2>
        <ul class="mb-0">
          <li>
            <a href="" style="color: #6B46C1; text-decoration: none">Django Forms Integration</a>
          </li>
          <li>
            <a href="" style="color: #6B46C1; text-decoration: none">Business Isolation</a>
          </li>
          <li>
            <a href="" style="color: #6B46C1; text-decoration: none">Partial Templates</a>
          </li>
        </ul>
      </div>
    </section>
  </div>
{% endblock content %}
